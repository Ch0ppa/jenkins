pipeline {
    agent {
        label 'windows-shared'
    }
    options { skipDefaultCheckout() }
    environment {
        PROJECT_SOLUTION_NAME = 'aspnet-get-started.sln'
    }
	stages {
	stage('Checkout') {
            steps {
                bat "git clone https://github.com/Ch0ppa/jenkins.git ${BUILD_NUMBER}"
                }}
	stage('checkDir') {
            steps {
                bat "cd ${WORKSPACE}\\${BUILD_NUMBER}" 
		bat "dir"
                }}	
        stage('Building the project') {
            steps {
                bat "\"${tool 'MSBuild_VS2019community'}\\msbuild.exe\" ${WORKSPACE}\\${PROJECT_SOLUTION_NAME} -r -m -v:q -t:rebuild /p:WebPublishMethod=Package /p:PackageAsSingleFile=true /p:SkipInvalidConfigurations=true /p:DeployOnBuild=true /p:PackageLocation=${WORKSPACE}\\project.zip"
                }
            }}
}
